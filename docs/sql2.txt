use gamporongo


DECLARE @SearchStr nvarchar(100) = '44.43'
 
DECLARE @Results TABLE(ColumnName nvarchar(370), ColumnValue nvarchar(3630))
 
SET NOCOUNT ON
 
DECLARE @TableName nvarchar(256), @ColumnName nvarchar(128), @SearchStr2 nvarchar(110)
SET  @TableName = ''
SET @SearchStr2 = QUOTENAME('' + @SearchStr + '','''')
 
WHILE @TableName IS NOT NULL
BEGIN
    SET @ColumnName = ''
    SET @TableName =
    (
        SELECT MIN(QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME))
        FROM    INFORMATION_SCHEMA.TABLES
        WHERE       TABLE_TYPE = 'BASE TABLE'
            AND QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME) > @TableName
            AND OBJECTPROPERTY(
                    OBJECT_ID(
                        QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME)
                         ), 'IsMSShipped'
                           ) = 0
    )
 
    WHILE (@TableName IS NOT NULL) AND (@ColumnName IS NOT NULL)
    BEGIN
        SET @ColumnName =
        (
            SELECT MIN(QUOTENAME(COLUMN_NAME))
            FROM    INFORMATION_SCHEMA.COLUMNS
            WHERE       TABLE_SCHEMA    = PARSENAME(@TableName, 2)
                AND TABLE_NAME  = PARSENAME(@TableName, 1)
                AND DATA_TYPE IN ('int', 'bigint', 'decimal', 'float')
                AND QUOTENAME(COLUMN_NAME) > @ColumnName
        )
 
        IF @ColumnName IS NOT NULL
        BEGIN
            INSERT INTO @Results
            EXEC
            (
                'SELECT ''' + @TableName + '.' + @ColumnName + ''', LEFT(' + @ColumnName + ', 3630)
                FROM ' + @TableName + ' (NOLOCK) ' +
                ' WHERE ' + @ColumnName + ' = ' + 'cast('+@SearchStr2 +' as float)'
            )
        END
    END
END
 
SELECT ColumnName, ColumnValue FROM @Results


--faltas de empleado (con valor)
select * from rhfal

select * from INGENE2022






SELECT
    sysobjects.name AS table_name,
    syscolumns.name AS column_name,
    systypes.name AS datatype,
    syscolumns.LENGTH AS LENGTH
FROM
    sysobjects
    INNER JOIN syscolumns ON sysobjects.id = syscolumns.id
    INNER JOIN systypes ON syscolumns.xtype = systypes.xtype
WHERE
    (sysobjects.xtype = 'U')
    and (
        UPPER(syscolumns.name) like upper('%PROYECTO%')
    )
ORDER BY
    sysobjects.name,
    syscolumns.colid


select * from gbper
where gbperDide='1531876'

select * from rhtrn where rhtrnNemp=74 and rhtrnNprd=6 and (rhtrnGlos like '%AFP%' or rhtrnGlos like '%aporte%')