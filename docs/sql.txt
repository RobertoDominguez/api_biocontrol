use gamporongo


--Nro	Nombre 	Crago	Nro Doc	Ext.	Genero	Fceha de ingreso	
--Haber basico	D.T.	Sueldo basico	Bono Antig√ºedad	Otros ingresos	Total Ganado	AFP	Ap. Nal. Solidario	RC-IVA	Otros egresos	Total Egresos	Liquido pagable	Firma


SELECT	gbperCPER,gbper.gbperNomb,rhcrg.rhcrgDesc,gbper.gbperDide,gbper.gbperExci,gbper.gbperSexo,rhemp.rhempFing
		,rhemp.rhempSldo,rhemp.RhempTUTD,rhemp.rhempSldo
     FROM gbper,rhemp,rhcrg
     WHERE gbper.gbperCPER=rhemp.rhempNemp AND rhcrg.rhcrgCcrg=rhemp.rhempCcrg
	 and gbperDide='3916631'




declare @cod int
set @cod=86

--antiguedad
SELECT sum(rhtrn.rhtrnImpt) as antiguedad
from rhtrn
where rhtrnNemp=@cod and month(rhtrn.rhtrnFtra)=6
and rhtrnGlos like '%antiguedad%'

--salario
SELECT sum(rhtrn.rhtrnImpt) as salario
from rhtrn
where rhtrnNemp=@cod and month(rhtrn.rhtrnFtra)=6
and rhtrnGlos like '%salario%'

--afp
SELECT sum(rhtrn.rhtrnImpt) as afp
from rhtrn
where rhtrnNemp=86 and month(rhtrn.rhtrnFtra)=6
and rhtrnGlos like '%afp%'

--solidario
SELECT sum(rhtrn.rhtrnImpt) as solidario
from rhtrn
where rhtrnNemp=@cod and month(rhtrn.rhtrnFtra)=6
and rhtrnGlos like '%solidario%'

--iva
SELECT sum(rhtrn.rhtrnImpt) as iva
from rhtrn
where rhtrnNemp=@cod and month(rhtrn.rhtrnFtra)=6
and rhtrnGlos like '%iva%'







--primer opcion
SELECT sum(rhtrn.rhtrnImpt) as valor
from rhtrn
where rhtrnNemp=3 and (rhtrn.rhtrnFtra between '31/05/2022' and '30/06/2022')
and rhtrnGlos like '%afp%'  -- salario iva afp solidario


SELECT *
from rhtrn
where rhtrnNemp=3 and (rhtrn.rhtrnFtra between '31/05/2022' and '30/06/2022')
and rhtrnGlos like '%afp%'  -- salario iva afp solidario

--segunda opcion
SELECT  sum(rhtrn.rhtrnImpt) as valor
from rhtrn
where rhtrnNemp=3 and MONTH(rhtrn.rhtrnFtra)=6
and rhtrnGlos like '%salario%' -- salario iva afp solidario antiguedad

SELECT *
from rhtrn
where rhtrnNemp=3 and MONTH(rhtrn.rhtrnFtra)=6
and rhtrnGlos like '%afp%' -- salario iva afp solidario




